---
import Button from "@/components/ui/Button.astro";
import SectionTitle from "@/components/ui/SectionTitle.astro";
import projectsData from "@/data/projects.json";
import { loadContent } from "@/utils/i18n";
import type { ProjectData } from "@/utils/types";
import Image from "astro/components/Image.astro";

interface Props {
  lang?: "en" | "es";
}

const { lang = "en" } = Astro.props;
const content = await loadContent();
const t = content.projects || {};
const projects = projectsData as ProjectData[];
const featuredProjects = projects.filter((project) => project.featured);
const otherProjects = projects.filter((project) => !project.featured);
---

<section
  id="projects"
  class="flex flex-col items-center p-8 min-h-lvh w-full bg-surface gap-8"
>
  <SectionTitle>
    {t.title?.[lang]}
  </SectionTitle>

  <div class="w-full max-w-[1280px] grid grid-cols-2 grid-flow-row gap-8">
    {
      featuredProjects.map((project) => (
        <article class="w-full flex flex-col rounded-lg overflow-hidden bg-secondary">
          <picture class="w-full aspect-video overflow-hidden">
            <Image
              src={project.image}
              alt={`project ${project.title?.["en"]}`}
              class=" w-full h-full object-cover object-center"
              inferSize
              width={100}
              height={100}
            />
          </picture>
          <div class="p-5 flex flex-col gap-4 flex-1">
            <h1 class="text-2xl text-text-primary font-bold">
              {project.title?.[lang]}
            </h1>
            <p class="text-text-secondary text-base">
              {project.description?.[lang]}
            </p>
            <h2 class="font-semibold text-sm mt-auto -mb-2">
              {t.technologies?.[lang]}
            </h2>
            <ul class="flex gap-3">
              {project.technologies.map((technology) => (
                <li class="px-3 py-1.5 rounded-full border-x-2 border-primary text-xs">
                  {technology}
                </li>
              ))}
            </ul>
            <div class="flex gap-4">
              <Button class="flex-1">{t.viewDemo?.[lang]}</Button>
              <Button variant="outline" class="flex-1">
                {t.viewCode?.[lang]}
              </Button>
            </div>
          </div>
        </article>
      ))
    }
  </div>
</section>

<script>
  document.addEventListener("DOMContentLoaded", () => {});
</script>
